@model SleepyTimeSoaps.Models.ProductsModel
@using SleepyTimeSoaps.Models

@{
    ViewBag.Title = "Products";
    Layout = "~/Views/Admin/_DashboardLayout.cshtml";
}

<!-- Content Wrapper -->
<div id="content-wrapper" class="d-flex flex-column">

    <!-- Main Content -->
    <div id="content" style="padding-top: 60px;">

        <div class="row">

            <!-- Area Chart -->
            <div class="col">
                <div class="card shadow mb-4">
                    <!-- Card Header - Dropdown -->
                    <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                        <h6 class="m-0 font-weight-bold text-primary">All Products</h6>
                        <input type="text" id="filterInput" onkeyup="myFilter()" placeholder="Filter..">
                    </div>
                    <!-- Card Body -->
                    <div class="card-body">
                        <table class="table" id="productTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th width="500px">Description</th>
                                    <th width="300px">Ingredients</th>
                                    <th>Type</th>
                                    <th>Category</th>
                                    <th>Tags</th>
                                    <th>Price</th>
                                    <th>Images</th>
                                </tr>
                            </thead>
                            @foreach (Product p in Model.Products)
                            {
                                <tr>
                                    <td>@p.ProductID</td>
                                    <td>@p.ProductName</td>
                                    <td>@p.ProductDescription</td>
                                    <td>@p.ProductIngredients</td>
                                    <td>@p.ProductType</td>
                                    <td>@p.ProductCategory</td>
                                    <td>
                                        @foreach (string s in p.ProductTags)
                                        {
                                            @(s + ", ")
                                        }
                                    </td>
                                    <td>@p.ProductPrice.ToString("c")</td>
                                    <td><a href="/Admin/DownloadImages/@p.ProductID"><i class="fas fa-download"></i></a></td>
                                </tr>
                            }
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Content Row -->

        <div class="row">

            <!-- Area Chart -->
            <div class="col">
                <div class="card shadow mb-4">
                    <!-- Card Header - Dropdown -->
                    <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                        <h6 class="m-0 font-weight-bold text-primary">Add New Product</h6>
                    </div>
                    <!-- Card Body -->
                    <div class="card-body">
                        @using (Html.BeginForm("AddProduct", "Admin"))
                        {
                            <div>
                                <div class="form-row">
                                    <div class="col">
                                        <div class="input-group mb-2 mr-sm-2">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text">Name</div>
                                            </div>
                                            <input type="text" class="form-control" id="ProductName" name="ProductName">
                                        </div>
                                    </div>

                                    <div class="col">
                                        <div class="input-group mb-2 mr-sm-2">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text">$</div>
                                            </div>
                                            <input type="number" step="0.01" class="form-control" id="ProductPrice" name="ProductPrice">
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="input-group mb-2 mr-sm-2">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text">Stock</div>
                                            </div>
                                            <input type="number" step="1" class="form-control" id="ProductStock" name="ProductStock">
                                        </div>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="col">
                                        <div class="input-group mb-2 mr-sm-2">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text">Category</div>
                                            </div>
                                            <input type="text" class="form-control" id="ProductCategory" name="ProductCategory">
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="input-group mb-2 mr-sm-2">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text">Scent</div>
                                            </div>
                                            <input type="text" class="form-control" id="ProductScent" name="ProductScent">
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="input-group mb-2 mr-sm-2">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text">Tags</div>
                                            </div>
                                            <input type="text" class="form-control" id="ProductTags" name="ProductTags">
                                        </div>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="col">
                                        <div class="input-group mb-2 mr-sm-2">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text">Primary Image URL</div>
                                            </div>
                                            <input type="text" class="form-control" id="ProductPrimaryImageURL" name="ProductPrimaryImageURL">
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="input-group mb-2 mr-sm-2">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text">Image URLs</div>
                                            </div>
                                            <input type="text" class="form-control" id="ProductScent" name="ProductImages">
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="input-group mb-2 mr-sm-2">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text">Type</div>
                                            </div>
                                            <select id="ProductType" name="ProductType" class="custom-select">
                                                <option value="Specialty Soap" selected>Soap</option>
                                                <option value="Bath Salt">Bath Salts</option>
                                                <option value="Wax Melts">Wax Melts</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="col">
                                        <div class="input-group mb-2 mr-sm-2">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text">Description</div>
                                            </div>
                                            <textarea class="form-control" id="ProductDescription" name="ProductDescription"></textarea>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="col">
                                        <div class="input-group mb-2 mr-sm-2">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text">Ingredients</div>
                                            </div>
                                            <textarea class="form-control" id="ProductIngredients" name="ProductIngredients"></textarea>
                                        </div>
                                    </div>
                                </div>

                                <button type="submit" class="btn btn-primary mb-2">Submit</button>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>


        <!-- /.container-fluid -->

    </div>
    <!-- End of Main Content -->
    <!-- Footer -->
    <footer class="sticky-footer bg-white">
        <div class="container my-auto">
            <div class="copyright text-center my-auto">
                <span>Copyright &copy; Your Website 2020</span>
            </div>
        </div>
    </footer>
    <!-- End of Footer -->

</div>
<!-- End of Content Wrapper -->
</div>
<!-- End of Page Wrapper -->

@if (ViewBag.Response != null && !string.IsNullOrWhiteSpace(ViewBag.Response))
{
    <div class="modal" id="responseModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Response</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    @ViewBag.Response
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
}

<script>
    function myFilter() {
        // Declare variables
        var input, filter, table, tr, td, i, txtValue;
        input = document.getElementById("filterInput");
        filter = input.value.toUpperCase();
        table = document.getElementById("productTable");
        tr = table.getElementsByTagName("tr");

        // Loop through all table rows, and hide those who don't match the search query
        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[1];
            if (td) {
                txtValue = td.textContent || td.innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }
    }
</script>

@Scripts.Render("~/bundles/jquery")
@Scripts.Render("~/bundles/bootstrap")

<script type="text/javascript">
    $(window).on('load', function () {
        $('#responseModal').modal('show');
    });
</script>
